<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<link crossorigin="" href="https://fonts.gstatic.com/" rel="preconnect"/>
<link as="style" href="https://fonts.googleapis.com/css2?display=swap&amp;family=Inter%3Awght%40400%3B500%3B600%3B700&amp;family=Roboto%3Awght%40300%3B400%3B500%3B700" onload="this.rel='stylesheet'" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<title>PAI 2025 - Actividades</title>
<link href="data:image/x-icon;base64," rel="icon" type="image/x-icon"/>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<style type="text/tailwindcss">
      :root {
        --primary-color: #4f46e5;
        --secondary-color: #f0f2f4;
        --text-primary: #111827;
        --text-secondary: #6b7280;
        --background-color: #f9fafb;
      }
      body {
        font-family: 'Roboto', 'Inter', sans-serif;
      }
      .material-symbols-outlined {
        font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
      }
    </style>
<link rel="stylesheet" href="../styles/sidebar.css">
<link rel="stylesheet" href="../styles/layout.css">
<link rel="stylesheet" href="../styles/actividades.css">
</head>
<body class="bg-[var(--background-color)]">
<div class="h-full min-h-screen w-full flex-col">
<!-- Header removed: sidebar will act as main navigation and reach the top of the viewport -->
<div class="flex-1">
  <div class="layout-with-sidebar">
    <div id="shared-sidebar" class="hidden md:block"></div>
    <main class="p-4 sm:p-6 md:p-8">
<div class="mx-auto max-w-7xl">
<div class="mb-6 flex flex-wrap items-center justify-between gap-4">
<h2 class="text-3xl font-bold text-[var(--text-primary)]">Gestión de Actividades</h2>
<button id="btn-nueva-actividad" class="flex items-center gap-2 rounded-md bg-[var(--primary-color)] px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-indigo-700 transition-colors">
<span class="material-symbols-outlined"> add </span>
              Nueva Actividad
            </button>
</div>

<!-- Formulario para crear/editar actividades -->
<div id="form-actividad" class="hidden mb-8 rounded-lg border border-gray-200 bg-white p-6 shadow-sm">
  <div class="mb-6 flex items-center justify-between">
    <h3 class="text-xl font-semibold text-[var(--text-primary)]">
      <span id="form-title">Nueva Actividad</span>
    </h3>
    <button id="btn-cerrar-form" class="rounded-full p-1 text-gray-400 hover:bg-gray-100 hover:text-gray-600">
      <span class="material-symbols-outlined">close</span>
    </button>
  </div>
  
  <form id="actividad-form" class="grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3">
    <!-- Información básica -->
    <div class="lg:col-span-3">
      <label class="block text-sm font-medium text-[var(--text-secondary)] mb-2">
        Descripción de la Actividad
      </label>
      <textarea 
        id="descripcion_actividad" 
        name="descripcion_actividad"
        rows="3" 
        class="block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"
        placeholder="Describa claramente la actividad a realizar"></textarea>
    </div>

    <!-- Área -->
    <div>
      <label class="block text-sm font-medium text-[var(--text-secondary)] mb-2">
        Área <span class="text-red-500">*</span>
      </label>
      <select 
        id="area_id" 
        name="area_id"
        required
        class="block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
        <option value="">Seleccionar área...</option>
      </select>
    </div>

    <!-- Subproceso -->
    <div>
      <label class="block text-sm font-medium text-[var(--text-secondary)] mb-2">
        Subproceso <span class="text-red-500">*</span>
      </label>
      <select 
        id="subproceso_id" 
        name="subproceso_id"
        required
        class="block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
        <option value="">Seleccionar subproceso...</option>
      </select>
    </div>

    <!-- MIPG -->
    <div>
      <label class="block text-sm font-medium text-[var(--text-secondary)] mb-2">
        Dimensión MIPG
      </label>
      <select 
        id="mipg_codigo" 
        name="mipg"
        class="block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
        <option value="">Seleccionar MIPG...</option>
      </select>
    </div>

    <!-- Objetivo Estratégico -->
    <div>
      <label class="block text-sm font-medium text-[var(--text-secondary)] mb-2">
        Objetivo Estratégico
      </label>
      <select 
        id="objetivo_id" 
        name="objetivo_id"
        class="block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
        <option value="">Seleccionar objetivo...</option>
      </select>
    </div>

    <!-- Estrategia -->
    <div>
      <label class="block text-sm font-medium text-[var(--text-secondary)] mb-2">
        Estrategia
      </label>
      <select 
        id="estrategia_id" 
        name="estrategia_id"
        class="block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
        <option value="">Seleccionar estrategia...</option>
      </select>
    </div>

    <!-- Línea de Acción -->
    <div>
      <label class="block text-sm font-medium text-[var(--text-secondary)] mb-2">
        Línea de Acción <span class="text-red-500">*</span>
      </label>
      <select 
        id="linea_id" 
        name="linea_id"
        required
        class="block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
        <option value="">Seleccionar línea...</option>
      </select>
    </div>

    <!-- Indicador -->
    <div>
      <label class="block text-sm font-medium text-[var(--text-secondary)] mb-2">
        Indicador
      </label>
      <select 
        id="indicador_id" 
        name="indicador_id"
        class="block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
        <option value="">Seleccionar indicador...</option>
      </select>
    </div>

    <!-- Meta del Indicador -->
    <div>
      <label class="block text-sm font-medium text-[var(--text-secondary)] mb-2">
        Meta del Indicador
      </label>
      <input 
        type="number" 
        id="meta_indicador_valor" 
        name="meta_indicador_valor"
        step="0.01"
        min="0"
        class="block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"
        placeholder="0.00">
    </div>

    <!-- Entregable -->
    <div class="lg:col-span-2">
      <label class="block text-sm font-medium text-[var(--text-secondary)] mb-2">
        Entregable
      </label>
      <input 
        type="text" 
        id="entregable" 
        name="entregable"
        class="block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"
        placeholder="Producto o entregable esperado">
    </div>

    <!-- Presupuesto Programado -->
    <div>
      <label class="block text-sm font-medium text-[var(--text-secondary)] mb-2">
        Presupuesto Programado
      </label>
      <input 
        type="number" 
        id="presupuesto_programado" 
        name="presupuesto_programado"
        step="0.01"
        min="0"
        class="block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"
        placeholder="0.00">
    </div>

    <!-- Fuente -->
    <div>
      <label class="block text-sm font-medium text-[var(--text-secondary)] mb-2">
        Fuente de Financiamiento
      </label>
      <select 
        id="fuente_financiacion" 
        name="fuente"
        class="block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
        <option value="">Seleccionar fuente...</option>
      </select>
    </div>

    <!-- Plan -->
    <div>
      <label class="block text-sm font-medium text-[var(--text-secondary)] mb-2">
        Plan <span class="text-red-500">*</span>
      </label>
      <select 
        id="plan_id" 
        name="plan_id"
        required
        class="block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
        <option value="">Seleccionar plan...</option>
      </select>
    </div>

    <!-- Responsable -->
    <div>
      <label class="block text-sm font-medium text-[var(--text-secondary)] mb-2">
        Responsable <span class="text-xs text-gray-400">(Auto-asignado)</span>
      </label>
      <input 
        type="text" 
        id="responsable" 
        name="responsable"
        readonly
        class="block w-full rounded-md border-gray-300 bg-gray-50 text-gray-600 shadow-sm sm:text-sm cursor-not-allowed"
        placeholder="Se asignará automáticamente al usuario actual"
        title="Este campo se llena automáticamente con el email del usuario logueado">
    </div>

    <!-- Fecha Inicio -->
    <div>
      <label class="block text-sm font-medium text-[var(--text-secondary)] mb-2">
        Fecha de Inicio Planeada
      </label>
      <input 
        type="date" 
        id="fecha_inicio_planeada" 
        name="fecha_inicio_planeada"
        class="block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
    </div>

    <!-- Fecha Fin -->
    <div>
      <label class="block text-sm font-medium text-[var(--text-secondary)] mb-2">
        Fecha de Fin Planeada
      </label>
      <input 
        type="date" 
        id="fecha_fin_planeada" 
        name="fecha_fin_planeada"
        class="block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
    </div>

    <!-- Estado -->
    <div>
      <label class="block text-sm font-medium text-[var(--text-secondary)] mb-2">
        Estado <span class="text-red-500">*</span>
      </label>
      <select 
        id="estado" 
        name="estado"
        required
        class="block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
        <option value="">Seleccionar estado...</option>
        <option value="Planeada">Planeada</option>
        <option value="En Progreso">En Progreso</option>
        <option value="Completada">Completada</option>
        <option value="Suspendida">Suspendida</option>
        <option value="Cancelada">Cancelada</option>
      </select>
    </div>

    <!-- Botones -->
    <div class="lg:col-span-3 flex gap-4 pt-4">
      <button 
        type="submit" 
        class="flex items-center gap-2 rounded-md bg-[var(--primary-color)] px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-indigo-700 transition-colors">
        <span class="material-symbols-outlined">save</span>
        <span id="btn-submit-text">Guardar Actividad</span>
      </button>
      <button 
        type="button" 
        id="btn-cancelar"
        class="flex items-center gap-2 rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 transition-colors">
        <span class="material-symbols-outlined">cancel</span>
        Cancelar
      </button>
    </div>
  </form>
</div>

<!-- Tabla de actividades -->
<div class="rounded-lg border border-gray-200 bg-white shadow-sm">
  <div class="px-6 py-4 border-b border-gray-200">
    <h3 class="text-lg font-medium text-[var(--text-primary)]">Lista de Actividades</h3>
    <p class="mt-1 text-sm text-[var(--text-secondary)]">Gestiona todas las actividades del plan de acción institucional</p>
  </div>
  
  <!-- Filtros -->
  <div class="px-6 py-4 border-b border-gray-200 bg-gray-50">
    <div class="grid grid-cols-1 gap-4 sm:grid-cols-2 md:grid-cols-4">
      <div>
        <label class="block text-xs font-medium text-[var(--text-secondary)] mb-1">Área</label>
        <select id="filtro-area" class="block w-full text-sm rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500">
          <option value="">Todas las áreas</option>
        </select>
      </div>
      <div>
        <label class="block text-xs font-medium text-[var(--text-secondary)] mb-1">Estado</label>
        <select id="filtro-estado" class="block w-full text-sm rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500">
          <option value="">Todos los estados</option>
          <option value="Planeada">Planeada</option>
          <option value="En Progreso">En Progreso</option>
          <option value="Completada">Completada</option>
          <option value="Suspendida">Suspendida</option>
          <option value="Cancelada">Cancelada</option>
        </select>
      </div>
      <div>
        <label class="block text-xs font-medium text-[var(--text-secondary)] mb-1">Plan</label>
        <select id="filtro-plan" class="block w-full text-sm rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500">
          <option value="">Todos los planes</option>
        </select>
      </div>
      <div class="flex items-end">
        <button id="btn-limpiar-filtros" class="w-full text-sm rounded-md border border-gray-300 bg-white px-3 py-2 text-gray-700 hover:bg-gray-50 transition-colors">
          Limpiar Filtros
        </button>
      </div>
    </div>
  </div>

  <div class="overflow-x-auto">
    <table class="min-w-full divide-y divide-gray-200">
      <thead class="bg-gray-50">
        <tr>
          <th class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500">Actividad</th>
          <th class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500">Área</th>
          <th class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500">Indicador</th>
          <th class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500">Meta</th>
          <th class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500">Responsable</th>
          <th class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500">Estado</th>
          <th class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500">Fechas</th>
          <th class="relative px-6 py-3"><span class="sr-only">Acciones</span></th>
        </tr>
      </thead>
      <tbody id="tabla-actividades" class="divide-y divide-gray-200 bg-white">
        <!-- Las filas se generarán dinámicamente -->
        <tr>
          <td colspan="8" class="px-6 py-12 text-center text-sm text-gray-500">
            <div class="flex flex-col items-center gap-2">
              <span class="material-symbols-outlined text-4xl text-gray-300">assignment</span>
              <p>No hay actividades registradas</p>
              <p class="text-xs">Usa el botón "Nueva Actividad" para comenzar</p>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

</div>
    </main>
  </div>
</div>

<script type="module" src="../lib/loader.js"></script>

<script type="module">
  import '../lib/session-guard.js';
  import { renderSidebar } from '../lib/sidebar-component.js';
  try { renderSidebar('#shared-sidebar'); } catch (e) { console.warn('renderSidebar failed', e); }
</script>

<script type="module" src="../pages_scripts/actividades.js"></script>

</body>
</html>


